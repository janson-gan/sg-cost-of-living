# Pipeline / Dockerfile
# This Dockerfile is used top build a Docker image for the pipeline application.
# 1. Starts from Python 3.10.
# 2. Sets the working directory to /app.
# 3. Creates a logs directory inside the container.
# 4. Copies the requirements.txt file to the container and installs the dependencies.
# 5. Copies the rest of the application files to the container.
# 6. Runs the orchestrator.py script when the container starts.

# Use an official Python runtime as 3.10 image
# Slim version is used to reduce the image size, so build faster and use less disk space
FROM python:3.10-slim
# Set environment variable to ensure that Python outputs logs immediately without buffering
ENV PYTHONUNBUFFERED=1
# Set the working directory in the container to /app
# All subsequent commands will be run from this directory
WORKDIR /app
# Create a logs folder inside the container to store logs generated by the application
# -p flag is used to create directory and avoid errors if the directory already exists
RUN mkdir -p logs
# Copy the requirements.txt file from the project to the working directory (/app) in the container
COPY requirements.txt .
# Install the dependencies specified in the requirements.txt file using pip
RUN pip install --no-cache-dir -r requirements.txt
# Copy the rest of the files from the project to the working directory (/app) in the container
COPY . .
# Define the command to run the application when the container starts
# In this case, it runs the orchestrator.py script using Python
CMD ["python", "orchestrator.py"]